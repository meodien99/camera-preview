{"version":3,"sources":["classie.js","main.js"],"names":["window","classReg","className","RegExp","toggleClass","elem","c","fn","hasClass","removeClass","addClass","document","documentElement","classList","contains","add","remove","test","replace","classie","has","toggle","define","amd","exports","module","throttle","delay","allowSample","e","setTimeout","getMousePos","posx","posy","event","pageX","pageY","clientX","clientY","body","scrollLeft","scrollTop","x","y","lineEq","y2","y1","x2","x1","currentVal","m","b","applyRoomTransform","transform","room","style","WebkitTransform","perspective","rotateX","rotateY","translateX","translateY","translateZ","roomTransform","applyRoomTransition","settings","transitionOpts","WebkitTransition","speed","easing","transition","removeRoomTransition","scaleRoom","factor","winsize","width","roomsize","container","initEvents","onSeatSelect","ev","selectSeat","target","planseats","forEach","planseat","addEventListener","onTiltCtrlClick","tilt","disableTilt","enableTilt","tiltCtrl","onMouseMove","requestAnimationFrame","mousepos","rotX","tiltRotation","height","rotY","onSelectSeats","intro","plan","playCtrl","zoomOutScreen","showTiltCtrl","selectSeatsCtrl","videoPlay","video","videoLoad","innerWidth","innerHeight","seat","seats","indexOf","previewSeat","st","getComputedStyle","parentNode","tr","getPropertyValue","values","split","z","seatCenterX","offsetLeft","side_margin","offsetWidth","tx","initTransform","ty","Math","abs","offsetHeight","tz","firstRowZ","row_front_gap","lastRowZ","totalRows","row_gap_amount","row_back","minRotY_1","maxRotY_1","initialTranslationX","finalTranslationX","rotY_1","minRotY_2","maxRotY_2","rotY_2","onEndTransition","callback","call","currentTime","play","load","init","prefix","lastTime","prefixes","cancelAnimationFrame","i","length","element","currTime","Date","getTime","timeToCall","max","id","clearTimeout","support","transitions","Modernizr","csstransitions","transEndEventNames","MozTransition","OTransition","msTransition","transEndEventName","prefixed","el","onEndCallbackFn","this","removeEventListener","querySelector","rows","slice","querySelectorAll","monitor","seat_width","seats_row","children"],"mappings":"CAeA,SAAAA,GAEA,YAIA,SAAAC,GAAAC,GACA,MAAA,IAAAC,QAAA,WAAAD,EAAA,YAgCA,QAAAE,GAAAC,EAAAC,GACA,GAAAC,GAAAC,EAAAH,EAAAC,GAAAG,EAAAC,CACAH,GAAAF,EAAAC,GA7BA,GAAAE,GAAAE,EAAAD,CAEA,cAAAE,UAAAC,iBACAJ,EAAA,SAAAH,EAAAC,GACA,MAAAD,GAAAQ,UAAAC,SAAAR,IAEAI,EAAA,SAAAL,EAAAC,GACAD,EAAAQ,UAAAE,IAAAT,IAEAG,EAAA,SAAAJ,EAAAC,GACAD,EAAAQ,UAAAG,OAAAV,MAIAE,EAAA,SAAAH,EAAAC,GACA,MAAAL,GAAAK,GAAAW,KAAAZ,EAAAH,YAEAQ,EAAA,SAAAL,EAAAC,GACAE,EAAAH,EAAAC,KACAD,EAAAH,UAAAG,EAAAH,UAAA,IAAAI,IAGAG,EAAA,SAAAJ,EAAAC,GACAD,EAAAH,UAAAG,EAAAH,UAAAgB,QAAAjB,EAAAK,GAAA,MASA,IAAAa,IAEAX,SAAAA,EACAE,SAAAA,EACAD,YAAAA,EACAL,YAAAA,EAEAgB,IAAAZ,EACAO,IAAAL,EACAM,OAAAP,EACAY,OAAAjB,EAIA,mBAAAkB,SAAAA,OAAAC,IAEAD,OAAAH,GACA,gBAAAK,SAEAC,OAAAD,QAAAL,EAGAnB,EAAAmB,QAAAA,GAGAnB,QCpFA,SAAAA,GACA,YAoCA,SAAA0B,GAAAnB,EAAAoB,GACA,GAAAC,IAAA,CAEA,OAAA,UAAAC,GACAD,IACAA,GAAA,EACAE,WAAA,WAAAF,GAAA,GAAAD,GACApB,EAAAsB,KAMA,QAAAE,GAAAF,GACA,GAAAG,GAAA,EACAC,EAAA,CACA,KAAAJ,EAAA,GAAAA,GAAA7B,EAAAkC,KASA,OARAL,GAAAM,OAAAN,EAAAO,OACAJ,EAAAH,EAAAM,MACAF,EAAAJ,EAAAO,QAEAP,EAAAQ,SAAAR,EAAAS,WACAN,EAAAH,EAAAQ,QAAA1B,SAAA4B,KAAAC,WAAA7B,SAAAC,gBAAA4B,WACAP,EAAAJ,EAAAS,QAAA3B,SAAA4B,KAAAE,UAAA9B,SAAAC,gBAAA6B,YAGAC,EAAAV,EACAW,EAAAV,GAKA,QAAAW,GAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GAEA,GAAAC,IAAAL,EAAAC,IAAAC,EAAAC,GACAG,EAAAL,EAAAI,EAAAF,CAEA,OAAAE,GAAAD,EAAAE,EAyEA,QAAAC,GAAAC,GACAC,EAAAC,MAAAC,gBAAAF,EAAAC,MAAAF,UAAAA,EACA,mBAAAI,EAAA,sBAAAJ,EAAAK,QAAA,uBAAAL,EAAAM,QAAA,oBAAAN,EAAAO,WAAA,OAAAP,EAAAQ,WAAA,OAAAR,EAAAS,WAAA,MACA,mBAAAL,EAAA,sBAAAM,GAAAL,QAAA,uBAAAK,GAAAJ,QAAA,oBAAAI,GAAAH,WAAA,OAAAG,GAAAF,WAAA,OAAAE,GAAAD,WAAA,MAGA,QAAAE,GAAAC,GACA,GAAAA,GAAAA,GAAAC,CACAZ,GAAAC,MAAAY,iBAAA,qBAAAF,EAAAG,MAAA,MAAAH,EAAAI,OACAf,EAAAC,MAAAe,WAAA,aAAAL,EAAAG,MAAA,MAAAH,EAAAI,OAGA,QAAAE,KACAjB,EAAAC,MAAAY,iBAAAb,EAAAC,MAAAe,WAAA,OAGA,QAAAE,KACA,GAAAC,GAAAC,EAAAC,MAAAC,EAAAlC,CACAmC,GAAAtB,MAAAC,gBAAAqB,EAAAtB,MAAAF,UAAA,WAAAoB,EAAA,IAAAA,EAAA,MAGA,QAAAK,KAEA,GAAAC,GAAA,SAAAC,GAAAC,EAAAD,EAAAE,QACAC,GAAAC,QAAA,SAAAC,GACAA,EAAAC,iBAAA,QAAAP,IAIA,IAAAQ,GAAA,WAEAC,EACAC,IAGAC,IAGAC,GAAAL,iBAAA,QAAAC,EAGA,IAAAK,GAAA,SAAAZ,GACAa,EAAA,WACA,IAAAL,EAAA,OAAA,CAEA,IAAAM,GAAA/D,EAAAiD,GAEAe,EAAAC,EAAAtC,QAAAK,GAAAL,SAAA,EAAAsC,EAAAtC,QAAAgB,EAAAuB,OAAAH,EAAAnD,EAAAqD,EAAAtC,SAAA,EACAwC,EAAAF,EAAArC,QAAAI,GAAAJ,SAAA,EAAAqC,EAAArC,QAAAe,EAAAC,MAAAmB,EAAApD,EAAAsD,EAAArC,SAAA,CAGAP,IAAAQ,WAAAG,GAAAH,WAAAC,WAAAE,GAAAF,WAAAC,WAAAC,GAAAD,WAAAJ,QAAAqC,EAAApC,QAAAuC,MAGAvF,UAAA2E,iBAAA,YAAAM,EAGA,IAAAO,GAAA,WACAhF,QAAAH,OAAAoF,EAAA,gBACAjF,QAAAJ,IAAAsF,EAAA,eACAlF,QAAAJ,IAAAuF,EAAA,iBACAC,EAAA,WACAC,MAGAC,GAAAnB,iBAAA,QAAAa,GAEAG,EAAAhB,iBAAA,QAAAoB,GACAC,EAAArB,iBAAA,QAAAsB,GAEA5G,EAAAsF,iBAAA,SAAA5D,EAAA,SAAAsD,GACAN,GAAAC,MAAA3E,EAAA6G,WAAAZ,OAAAjG,EAAA8G,aACAtC,KACA,KAGA,QAAAgC,KACArF,QAAAJ,IAAA4E,EAAA,iBAGA,QAAAV,GAAAI,GACA,GAAAlE,QAAAC,IAAAiE,EAAA,uBACA,OAAA,CAEA,IAAAlE,QAAAC,IAAAiE,EAAA,uBAEA,MADAlE,SAAAH,OAAAqE,EAAA,wBACA,CAEAlE,SAAAJ,IAAAsE,EAAA,sBAEA,IAAA0B,GAAAC,EAAA7B,EAAA8B,QAAA5B,GACA6B,GAAAH,GAGA,QAAAG,GAAAH,GACAtB,IACAzB,GACA,IAAAmD,GAAAnH,EAAAoH,iBAAAL,EAAAM,WAAA,MACAC,EAAAH,EAAAI,iBAAA,sBACAJ,EAAAI,iBAAA,mBACAJ,EAAAI,iBAAA,kBACAJ,EAAAI,iBAAA,iBACAJ,EAAAI,iBAAA,cACA,qEAEA,IAAA,SAAAD,EAAA,CAEA,GAAAE,GAAAF,EAAAG,MAAA,KAAA,GACAD,EAAAA,EAAAC,MAAA,KAAA,GACAD,EAAAA,EAAAC,MAAA,KAEA9E,EAAA6E,EAAA,IACAE,EAAAF,EAAA,IAEAG,EAAAZ,EAAAa,WAAAC,EAAA,EAAAd,EAAAe,YAAA,EAEAC,EAAAJ,EAAA/C,EAAAlC,EAAA,EAAAsF,EAAApE,YAAAgB,EAAAlC,EAAA,EAAAiF,GAAAK,EAAApE,YAAA+D,EAAA/C,EAAAlC,EAAA,GACAuF,EAAArD,EAAAjC,EAAA,GAAAiC,EAAAjC,EAAAuF,KAAAC,IAAAxF,IAAAoE,EAAAqB,aAAA,GACAC,EAAAH,KAAAC,IAAAT,GAAA,GAEAY,EAAA1D,EAAA8C,EAAAa,EACAC,EAAAF,GAAAG,EAAA,EAAAC,GAAAC,EAEAC,EAAA,EAAAC,EAAA,GACAC,EAAA,EAAAC,EAAAnE,EAAAlC,EAAA,EACAsG,EAAApG,EAAAgG,EAAAC,EAAAC,EAAAC,EAAAhB,GACAkB,EAAA,EAAAC,EAAA,GACAC,EAAAvG,EAAAqG,EAAAC,EAAAJ,EAAAC,EAAAhB,GAEA7B,EAAAtD,EAAAoG,EAAAG,EAAAX,EAAAF,EAAAJ,KAAAC,IAAAT,GAGA3D,KACAH,WAAAmE,EACAlE,WAAAoE,EACAnE,WAAAuE,EACA3E,QAAA,EACAC,QAAAuC,GAIA9C,IAEAgG,EAAA9F,EAAA,WACAiB,OAIA,QAAAgC,GAAA8C,GACArF,GAAAI,MAAA,KAAAC,OAAA,SACAjB,EAAA4E,GACAoB,EAAA9F,EAAA,WACAiB,IACA8E,EAAAC,SAIA,QAAA7D,KACAtE,QAAAJ,IAAA4E,EAAA,oBACAH,GAAA,EAGA,QAAAE,KACAvE,QAAAH,OAAA2E,EAAA,oBACAH,GAAA,EAGA,QAAAkB,KAEAvF,QAAAH,OAAAsF,EAAA,iBACAK,EAAA4C,YAAA,EACA5C,EAAA6C,OAGA,QAAA5C,KAEAzF,QAAAJ,IAAAuF,EAAA,iBACAK,EAAA8C,OAGA,QAAAC,KAEAlF,IAEApB,GACAQ,WAAA,EACAC,WAAA,EACAC,WAAA,KACAJ,QAAA,EACAC,QAAA,IAGAmB,IAzUA,IAAA,GADA6E,GANAC,EAAA,EACAC,EAAA,kBAAApC,MAAA,KAEA5B,EAAA7F,EAAA6F,sBACAiE,EAAA9J,EAAA8J,qBAGAC,EAAA,EAAAA,EAAAF,EAAAG,UACAnE,IAAAiE,GADAC,IAIAJ,EAAAE,EAAAE,GACAlE,EAAAA,GAAA7F,EAAA2J,EAAA,yBACAG,EAAAA,GAAA9J,EAAA2J,EAAA,yBACA3J,EAAA2J,EAAA,8BAIA9D,IAAAiE,IACAjE,EAAA,SAAAwD,EAAAY,GACA,GAAAC,IAAA,GAAAC,OAAAC,UACAC,EAAAnC,KAAAoC,IAAA,EAAA,IAAAJ,EAAAN,IACAW,EAAAvK,EAAA8B,WAAA,WACAuH,EAAAa,EAAAG,IACAA,EAEA,OADAT,GAAAM,EAAAG,EACAE,GAGAT,EAAA,SAAAS,GACAvK,EAAAwK,aAAAD,IA4CA,IAAAE,IAAAC,YAAAC,UAAAC,gBACAC,GACA1G,iBAAA,sBACA2G,cAAA,gBACAC,YAAA,iBACAC,aAAA,kBACA1G,WAAA,iBAEA2G,EAAAJ,EAAAF,UAAAO,SAAA,eACA9B,EAAA,SAAA+B,EAAA9B,GACA,GAAA+B,GAAA,SAAApG,GACA,GAAAyF,EAAAC,YAAA,CACA,GAAA1F,EAAAE,QAAAmG,KAAA,MACAA,MAAAC,oBAAAL,EAAAG,GAEA/B,GAAA,kBAAAA,IAAAA,EAAAC,KAAA+B,MAGAZ,GAAAC,YACAS,EAAA7F,iBAAA2F,EAAAG,GAEAA,KAGAvG,EAAAlE,SAAA4K,cAAA,cACAjI,EAAAuB,EAAA0G,cAAA,SACAC,KAAAC,MAAAnC,KAAAhG,EAAAoI,iBAAA,iBACAjD,EAAA+C,EAAAxB,OACAhD,KAAAyE,MAAAnC,KAAAhG,EAAAoI,iBAAA,eACArF,EAAA1F,SAAA4K,cAAA,SACApG,KAAAsG,MAAAnC,KAAAjD,EAAAqF,iBAAA,eACAC,EAAArI,EAAAiI,cAAA,WACA5E,EAAAgF,EAAAJ,cAAA,SACAjF,EAAAqF,EAAAJ,cAAA,uBACAnF,EAAAuF,EAAAJ,cAAA,UACA9E,EAAAL,EAAAmF,cAAA,wBACA5F,EAAAhF,SAAA4K,cAAA,uBACAvF,GACAtC,QAAA,GACAC,QAAA,IAEA6B,GAAA,EACAd,GACAC,MAAA3E,EAAA6G,WACAZ,OAAAjG,EAAA8G,aAEA8E,EAAA5E,EAAA,GAAAc,YACA+D,EAAAL,EAAA,GAAAM,SAAA9B,OACAnC,EAAA,EAAA+D,EAEArD,EAAA,IACAI,EAAA,IACAD,EAAA,EACAjF,EAAA,IACAS,GAAAE,MAAA,IAAAC,OAAA,2BAEAO,GACAlC,EAAAmJ,EAAAD,EAAA/D,EAAAa,EAAAkD,EACAjJ,EAAA,IACA+E,EAAA,KAEAM,GACApE,WAAA,EACAC,WAAAe,EAAAjC,EAAA,IACAmB,WAAA,EACAJ,QAAA,IACAC,QAAA,GAEAI,GAAAiE,CAqMA0B,MAEA1J","file":"uglify.js","sourcesContent":["/*!\n * classie v1.0.1\n * class helper functions\n * from bonzo https://github.com/ded/bonzo\n * MIT license\n *\n * classie.has( elem, 'my-class' ) -> true/false\n * classie.add( elem, 'my-new-class' )\n * classie.remove( elem, 'my-unwanted-class' )\n * classie.toggle( elem, 'my-class' )\n */\n\n/*jshint browser: true, strict: true, undef: true, unused: true */\n/*global define: false, module: false */\n\n( function( window ) {\n\n'use strict';\n\n// class helper functions from bonzo https://github.com/ded/bonzo\n\nfunction classReg( className ) {\n  return new RegExp(\"(^|\\\\s+)\" + className + \"(\\\\s+|$)\");\n}\n\n// classList support for class management\n// altho to be fair, the api sucks because it won't accept multiple classes at once\nvar hasClass, addClass, removeClass;\n\nif ( 'classList' in document.documentElement ) {\n  hasClass = function( elem, c ) {\n    return elem.classList.contains( c );\n  };\n  addClass = function( elem, c ) {\n    elem.classList.add( c );\n  };\n  removeClass = function( elem, c ) {\n    elem.classList.remove( c );\n  };\n}\nelse {\n  hasClass = function( elem, c ) {\n    return classReg( c ).test( elem.className );\n  };\n  addClass = function( elem, c ) {\n    if ( !hasClass( elem, c ) ) {\n      elem.className = elem.className + ' ' + c;\n    }\n  };\n  removeClass = function( elem, c ) {\n    elem.className = elem.className.replace( classReg( c ), ' ' );\n  };\n}\n\nfunction toggleClass( elem, c ) {\n  var fn = hasClass( elem, c ) ? removeClass : addClass;\n  fn( elem, c );\n}\n\nvar classie = {\n  // full names\n  hasClass: hasClass,\n  addClass: addClass,\n  removeClass: removeClass,\n  toggleClass: toggleClass,\n  // short names\n  has: hasClass,\n  add: addClass,\n  remove: removeClass,\n  toggle: toggleClass\n};\n\n// transport\nif ( typeof define === 'function' && define.amd ) {\n  // AMD\n  define( classie );\n} else if ( typeof exports === 'object' ) {\n  // CommonJS\n  module.exports = classie;\n} else {\n  // browser global\n  window.classie = classie;\n}\n\n})( window );",";(function(window) {\n   'use strict';\n\n   var lastTime = 0;\n   var prefixes = 'webkit moz ms o'.split(' ');\n   // get unprefixed rAF and cAF, if present\n   var requestAnimationFrame = window.requestAnimationFrame;\n   var cancelAnimationFrame = window.cancelAnimationFrame;\n   // loop through vendor prefixes and get prefixed rAF and cAF\n   var prefix;\n   for( var i = 0; i < prefixes.length; i++ ) {\n      if ( requestAnimationFrame && cancelAnimationFrame ) {\n         break;\n      }\n      prefix = prefixes[i];\n      requestAnimationFrame = requestAnimationFrame || window[ prefix + 'RequestAnimationFrame' ];\n      cancelAnimationFrame  = cancelAnimationFrame  || window[ prefix + 'CancelAnimationFrame' ] ||\n         window[ prefix + 'CancelRequestAnimationFrame' ];\n   }\n\n   // fallback to setTimeout and clearTimeout if either request/cancel is not supported\n   if ( !requestAnimationFrame || !cancelAnimationFrame ) {\n      requestAnimationFrame = function( callback, element ) {\n         var currTime = new Date().getTime();\n         var timeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\n         var id = window.setTimeout( function() {\n            callback( currTime + timeToCall );\n         }, timeToCall );\n         lastTime = currTime + timeToCall;\n         return id;\n      };\n\n      cancelAnimationFrame = function( id ) {\n         window.clearTimeout( id );\n      };\n   }\n\n   function throttle(fn, delay) {\n      var allowSample = true;\n\n      return function(e) {\n         if (allowSample) {\n            allowSample = false;\n            setTimeout(function() { allowSample = true; }, delay);\n            fn(e);\n         }\n      };\n   }\n\n   // from http://www.quirksmode.org/js/events_properties.html#position\n   function getMousePos(e) {\n      var posx = 0;\n      var posy = 0;\n      if (!e) var e = window.event;\n      if (e.pageX || e.pageY) {\n         posx = e.pageX;\n         posy = e.pageY;\n      }\n      else if (e.clientX || e.clientY) {\n         posx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\n         posy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\n      }\n      return {\n         x : posx,\n         y : posy\n      }\n   }\n\n   // equation of a line\n   function lineEq(y2, y1, x2, x1, currentVal) {\n      // y = mx + b\n      var m = (y2 - y1) / (x2 - x1),\n      b = y1 - m * x1;\n\n      return m * currentVal + b;\n   }\n\n   var support = {transitions : Modernizr.csstransitions},\n      transEndEventNames = {\n         'WebkitTransition': 'webkitTransitionEnd',\n         'MozTransition': 'transitionend',\n         'OTransition': 'oTransitionEnd',\n         'msTransition': 'MSTransitionEnd',\n         'transition': 'transitionend'\n      },\n      transEndEventName = transEndEventNames[Modernizr.prefixed('transition')],\n      onEndTransition = function(el, callback) {\n         var onEndCallbackFn = function( ev ) {\n            if( support.transitions ) {\n               if( ev.target != this ) return;\n               this.removeEventListener( transEndEventName, onEndCallbackFn );\n            }\n            if( callback && typeof callback === 'function' ) { callback.call(this); }\n         };\n\n         if( support.transitions ) {\n            el.addEventListener( transEndEventName, onEndCallbackFn );\n         } else {\n            onEndCallbackFn();\n         }\n      },\n      container = document.querySelector('.container'),\n      room = container.querySelector('.cube'),\n      rows = [].slice.call(room.querySelectorAll('.rows > .row')),\n      totalRows = rows.length,\n      seats = [].slice.call(room.querySelectorAll('.row__seat')),\n      plan = document.querySelector('.plan'),\n      planseats = [].slice.call(plan.querySelectorAll('.row__seat')),\n      monitor = room.querySelector('.screen'),\n      video = monitor.querySelector('video'),\n      playCtrl = monitor.querySelector('button.action__play'),\n      intro = monitor.querySelector('.intro'),\n      selectSeatsCtrl = intro.querySelector('button.action__seats'),\n      tiltCtrl = document.querySelector('.action__lookaround'),\n      tiltRotation = {\n         rotateX : 25,\n         rotateY : 15\n      },\n      tilt = false,\n      winsize = {\n         width: window.innerWidth,\n         height: window.innerHeight\n      },\n      seat_width = seats[0].offsetWidth,\n      seats_row = rows[0].children.length,\n      side_margin = 4 * seat_width,\n\n      row_front_gap = 800,\n      row_back = 100,\n      row_gap_amount = 2,\n      perspective = 2000,\n      transitionOpts = {'speed' : 1000, 'easing' : 'cubic-bezier(.7,0,.3,1)'},\n\n      roomsize = {\n         x : seats_row * seat_width + side_margin + row_gap_amount * seat_width,\n         y : 1000, // SCSS $cube_y\n         z : 3000 // SCSS $cube_z\n      },\n      initTransform = {\n         translateX : 0,\n         translateY : roomsize.y/3.5,\n         translateZ : 0,\n         rotateX : -15,\n         rotateY : 0\n      },\n      roomTransform = initTransform;\n\n      function applyRoomTransform(transform) {\n         room.style.WebkitTransform = room.style.transform = transform ?\n         'translate3d(0,0,' + perspective + 'px) rotate3d(1,0,0,' + transform.rotateX + 'deg) rotate3d(0,1,0,' + transform.rotateY + 'deg) translate3d(' + transform.translateX + 'px, ' + transform.translateY + 'px, ' + transform.translateZ + 'px)' :\n         'translate3d(0,0,' + perspective + 'px) rotate3d(1,0,0,' + roomTransform.rotateX + 'deg) rotate3d(0,1,0,' + roomTransform.rotateY + 'deg) translate3d(' + roomTransform.translateX + 'px, ' + roomTransform.translateY + 'px, ' + roomTransform.translateZ + 'px)';\n      }\n\n      function applyRoomTransition(settings) {\n         var settings = settings || transitionOpts;\n         room.style.WebkitTransition = '-webkit-transform ' + settings.speed + 'ms ' + settings.easing;\n         room.style.transition = 'transform ' + settings.speed + 'ms ' + settings.easing;\n      }\n\n      function removeRoomTransition() {\n         room.style.WebkitTransition = room.style.transition = 'none';\n      }\n\n      function scaleRoom() {\n         var factor = winsize.width / roomsize.x;\n         container.style.WebkitTransform = container.style.transform = 'scale3d(' + factor + ',' + factor + ',1)';\n      }\n\n      function initEvents() {\n      // select a seat\n      var onSeatSelect = function(ev) { selectSeat(ev.target); };\n      planseats.forEach(function(planseat) {\n         planseat.addEventListener('click', onSeatSelect);\n      });\n\n      // enabling/disabling the tilt\n      var onTiltCtrlClick = function() {\n         // if tilt is enabled..\n         if( tilt ) {\n            disableTilt();\n         }\n         else {\n            enableTilt();\n         }\n      };\n      tiltCtrl.addEventListener('click', onTiltCtrlClick);\n\n      // mousemove event / tilt functionality\n      var onMouseMove = function(ev) {\n         requestAnimationFrame(function() {\n            if( !tilt ) return false;\n\n            var mousepos = getMousePos(ev),\n               // transform values\n               rotX = tiltRotation.rotateX ? roomTransform.rotateX -  (2 * tiltRotation.rotateX / winsize.height * mousepos.y - tiltRotation.rotateX) : 0,\n               rotY = tiltRotation.rotateY ? roomTransform.rotateY +  (2 * tiltRotation.rotateY / winsize.width * mousepos.x - tiltRotation.rotateY) : 0;\n\n            // apply transform\n            applyRoomTransform({'translateX' : roomTransform.translateX, 'translateY' : roomTransform.translateY, 'translateZ' : roomTransform.translateZ, 'rotateX' : rotX, 'rotateY' : rotY});\n         });\n      };\n      document.addEventListener('mousemove', onMouseMove);\n\n      // select seats control click (intro button): show the room layout\n      var onSelectSeats = function() {\n         classie.remove(intro, 'intro__shown');\n         classie.add(plan, 'plan__shown');\n         classie.add(playCtrl, 'action__faded');\n         zoomOutScreen(function() {\n            showTiltCtrl();\n         });\n      };\n      selectSeatsCtrl.addEventListener('click', onSelectSeats);\n\n      playCtrl.addEventListener('click', videoPlay);\n      video.addEventListener('ended', videoLoad);\n\n      window.addEventListener('resize', throttle(function(ev) {\n         winsize = {width: window.innerWidth, height: window.innerHeight};\n         scaleRoom();\n      }, 10));\n   }\n\n   function showTiltCtrl() {\n      classie.add(tiltCtrl, 'action__shown');\n   }\n\n   function selectSeat(planseat) {\n      if( classie.has(planseat, 'row__seat__reserved') ) {\n         return false;\n      }\n      if( classie.has(planseat, 'row__seat__selected') ) {\n         classie.remove(planseat, 'row__seat__selected');\n         return false;\n      }\n      classie.add(planseat, 'row__seat__selected');\n\n      var seat = seats[planseats.indexOf(planseat)];\n      previewSeat(seat);\n   }\n\n   function previewSeat(seat) {\n      disableTilt();\n      applyRoomTransition();\n      var st = window.getComputedStyle(seat.parentNode, null),\n         tr = st.getPropertyValue('-webkit-transform') ||\n         st.getPropertyValue('-moz-transform') ||\n         st.getPropertyValue('-ms-transform') ||\n         st.getPropertyValue('-o-transform') ||\n         st.getPropertyValue('transform') ||\n         'Either no transform set or your browser doesn´t do getComputedStyle';\n\n      if( tr === 'none' ) return;\n\n      var values = tr.split('(')[1],\n         values = values.split(')')[0],\n         values = values.split(','),\n\n         y = values[13],\n         z = values[14],\n\n         seatCenterX = seat.offsetLeft + side_margin/2 + seat.offsetWidth/2,\n\n         tx = seatCenterX < roomsize.x/2 ? initTransform.translateX + (roomsize.x/2 - seatCenterX) : initTransform.translateX - (seatCenterX - roomsize.x/2),\n         ty = roomsize.y/2 - (roomsize.y - Math.abs(y)) + seat.offsetHeight + 10, // add a small extra\n         tz = Math.abs(z)+10,\n\n         firstRowZ = roomsize.z - row_front_gap,\n         lastRowZ = firstRowZ - (totalRows - 1 + row_gap_amount) * row_back,\n\n         minRotY_1 = 0, maxRotY_1 = 20,\n         initialTranslationX = 0, finalTranslationX = roomsize.x/2,\n         rotY_1 = lineEq(minRotY_1, maxRotY_1, initialTranslationX, finalTranslationX, tx),\n         minRotY_2 = 0, maxRotY_2 = 50,\n         rotY_2 = lineEq(minRotY_2, maxRotY_2, initialTranslationX, finalTranslationX, tx),\n\n         rotY = lineEq(rotY_1, rotY_2, lastRowZ, firstRowZ, Math.abs(z));\n\n\n         roomTransform = {\n            translateX : tx,\n            translateY : ty,\n            translateZ : tz,\n            rotateX : 0,//rotX,\n            rotateY : rotY\n         };\n\n         // apply transform\n         applyRoomTransform();\n\n         onEndTransition(room, function() {\n            removeRoomTransition();\n         });\n      }\n\n      function zoomOutScreen(callback) {\n         applyRoomTransition({'speed' : 1500, 'easing' : 'ease'});\n         applyRoomTransform(initTransform);\n         onEndTransition(room, function() {\n            removeRoomTransition();\n            callback.call();\n         });\n      }\n\n      function disableTilt() {\n         classie.add(tiltCtrl, 'action__disabled');\n         tilt = false;\n      }\n\n      function enableTilt() {\n         classie.remove(tiltCtrl, 'action__disabled');\n         tilt = true;\n      }\n\n      function videoPlay() {\n      // hide the play control\n      classie.remove(playCtrl, 'action__shown');\n      video.currentTime = 0;\n      video.play();\n   }\n\n   function videoLoad() {\n      // show the play control\n      classie.add(playCtrl, 'action__shown');\n      video.load();\n   }\n\n   function init() {\n      // scale room to fit viewport\n      scaleRoom();\n      // initial view (zoomed screen)\n      applyRoomTransform({\n         'translateX' : 0,\n         'translateY' : 0,\n         'translateZ' : 1300,\n         'rotateX' : 0,\n         'rotateY' : 0\n      });\n      // bind events\n      initEvents();\n   }\n\n   init();\n\n})(window);"]}